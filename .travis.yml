language: cpp
env:
  global:
  - PACKAGE_NAME=GlobalProtect
# safelist
dist: xenial
branches:
  only:
  - master
# Recursive Cloning
git:
  depth: false
before_install:
- sudo add-apt-repository universe
- sudo apt update
- sudo apt -y --install-suggests install fakeroot
- sudo apt -y --install-suggests install debhelper
- sudo apt -y --install-suggests install qt5-default
- sudo apt -y --install-suggests install qttools5-dev
- sudo apt -y --install-suggests install libqt5websockets5-dev
- sudo pip install git-archive-all
- export BUILD_VERSION=$(date "+%Y%m%d").$TRAVIS_BUILD_NUMBER
- export PACKAGE_NAME_VERSION=$PACKAGE_NAME.$BUILD_VERSION.deb
- sudo apt -q update
script:
- git-archive-all --force-submodules --prefix=globalprotect-openconnect-1.3.0/ ../globalprotect-openconnect_1.3.0.orig.tar.gz
- cd ..
- tar -xzvf globalprotect-openconnect_1.3.0.orig.tar.gz
- cd globalprotect-openconnect-1.3.0
- fakeroot dpkg-buildpackage -uc -us -sa 2>&1 | tee ../build.log
- ls
# mv $PACKAGE_NAME.deb $PACKAGE_NAME_VERSION
after_success:
- echo Done!
# ls -l $PACKAGE_NAME_VERSION
# md5sum $PACKAGE_NAME_VERSION
# dpkg --contents $PACKAGE_NAME_VERSION
